## Easy Reversy (kinda ez)

9662 pts

### Description

This should be easy ;)

**`PwnsD4y`**

[Easy_Reversy](./Easy_Reversy)

### Solve

opening the the file in binary ninja we get messy low level code,

```c
int32_t main(int32_t argc, char** argv, char** envp)
if (ptrace(PTRACE_TRACEME, 0, 0, 0) == -1)
    puts(&data_2008)
else
    puts("Enter the passphrase to enter: ")
    void var_78
    __isoc99_scanf(&data_2030, &var_78)
    if (strncmp(&var_78, "password123!", "password123!") != 0)
        puts("haha nice try")
    else
        puts("Access Granted!")
        for (int32_t var_c_1 = 0; var_c_1 s<= 33; var_c_1 = var_c_1 + 1)
            int32_t rax_7 = *((var_c_1 << 2) + &data_4060)
            *((var_c_1 << 2) + &data_4060) = (rax_7 + (rax_7 u>> 0x1f)) s>> 1
        sub_127f()
return 0
void sub_127f()
for (int32_t var_c = 0; var_c s<= 33; var_c = var_c + 1)
    *((var_c << 2) + &data_41c0) = *((var_c << 2) + &data_4100) ^ *((var_c << 2) + &data_4060)
    putchar(*((var_c << 2) + &data_41c0))
```

reading the code we see that it compares the input to `password123!` and if it is correct it will print the flag.
so we just need to run it and enter the `password123!`, and we get the flag :)

NOPE! entering the password doesn't work for some reason, trust me i've tried it many times.
next step is understanding what the code does when access is granted, and mimic it

```c
 puts("Access Granted!")
        for (int32_t var_c_1 = 0; var_c_1 s<= 33; var_c_1 = var_c_1 + 1)
            int32_t rax_7 = *((var_c_1 << 2) + &data_4060)
            *((var_c_1 << 2) + &data_4060) = (rax_7 + (rax_7 u>> 0x1f)) s>> 1
        sub_127f()
```

```c
void sub_127f()
for (int32_t var_c = 0; var_c s<= 33; var_c = var_c + 1)
    *((var_c << 2) + &data_41c0) = *((var_c << 2) + &data_4100) ^ *((var_c << 2) + &data_4060)
    putchar(*((var_c << 2) + &data_41c0))
```

it does some weird calculations on the data in `data_4060` and then calls `sub_127f` which xors the data in `data_4100` with the data in `data_4060` and prints it.

lets get the data in `data_4060` and `data_4100`.

```c
unsigned int DAT_00104060[] = {
    0x24, 0x00, 0x00, 0x00, 0x9c, 0x00, 0x00, 0x00, 0x6a, 0x00, 0x00, 0x00, 0x2a, 0x00, 0x00, 0x00,
    0x78, 0x00, 0x00, 0x00, 0xa2, 0x00, 0x00, 0x00, 0x1a, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00,
    0x8c, 0x00, 0x00, 0x00, 0x6c, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00,
    0x88, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0xb2, 0x00, 0x00, 0x00, 0x2e, 0x00, 0x00, 0x00,
    0x1e, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x78, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00,
    0x06, 0x00, 0x00, 0x00, 0xaa, 0x00, 0x00, 0x00, 0x78, 0x00, 0x00, 0x00, 0x96, 0x00, 0x00, 0x00,
    0xbe, 0x00, 0x00, 0x00, 0xae, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0xc8, 0x00, 0x00, 0x00,
    0x42, 0x00, 0x00, 0x00, 0x68, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00,
    0x6e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

unsigned int DAT_00104100[] = {
    0x5f, 0x00, 0x00, 0x00, 0x2b, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x74, 0x00, 0x00, 0x00,
    0x7f, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x7c, 0x00, 0x00, 0x00,
    0x11, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x69, 0x00, 0x00, 0x00, 0x69, 0x00, 0x00, 0x00,
    0x1b, 0x00, 0x00, 0x00, 0x6e, 0x00, 0x00, 0x00, 0x69, 0x00, 0x00, 0x00, 0x79, 0x00, 0x00, 0x00,
    0x3c, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x68, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00,
    0x32, 0x00, 0x00, 0x00, 0x26, 0x00, 0x00, 0x00, 0x63, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00,
    0x6b, 0x00, 0x00, 0x00, 0x24, 0x00, 0x00, 0x00, 0x7f, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00,
    0x15, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x68, 0x00, 0x00, 0x00, 0x71, 0x00, 0x00, 0x00,
    0x67, 0x00, 0x00, 0x00, 0x7d, 0x00, 0x00, 0x00};
```

thanks binary ninja cloud for making it easy to copy the data, *said sarcastically** (it's a pain)

now we need to reverse the calculations on `data_4060` and `data_4100` to get the flag.
i did it in `c` cuz i was afraid that it would be heavy duty calculations and python is 🐢

```c

#include <stdio.h>

void FUN_0010127f(void);

unsigned int DAT_00104060[] = {
    0x24, 0x9c, 0x6a, 0x2a, 0x78, 0xa2, 0x1a, 0x0e, 0x8c, 0x6c, 0x0a, 0x0a, 0x88, 0x54, 0xb2, 0x2e, 0x1e, 0x0e, 0x78, 0x58, 0x06, 0xaa, 0x78, 0x96, 0xbe, 0xae, 0x40, 0xc8, 0x42, 0x68, 0x0a, 0x08, 0x6e, 
    };
// consised
unsigned int DAT_00104100[] = {
    0x5f, 0x2b, 0x41, 0x74, 0x7f, 0x05, 0x4b, 0x7c, 0x11, 0x05, 0x69, 0x69, 0x1b, 0x6e, 0x69, 0x79, 0x3c, 0x58, 0x68, 0x44, 0x32, 0x26, 0x63, 0x3c, 0x6b, 0x24, 0x7f, 0x33, 0x15, 0x46, 0x68, 0x71, 0x67, 0x7d, };
int main()
{
    int iVar1;
    int local_c;

    iVar1 = 0;

    if (iVar1 == 0)
    {
        printf("Access Granted!\n");

        for (local_c = 0; local_c < 0x22; local_c = local_c + 1)
        {
            *((int *)(&DAT_00104060) + local_c) = *((int *)(&DAT_00104060) + local_c) / 2;
        }
        FUN_0010127f();
    }

    return 0;
}

void FUN_0010127f(void)
{
    int local_c;
    unsigned int DAT_001041c0[0x22] = {0};

    for (local_c = 0; local_c < 0x22; local_c = local_c + 1)
    {
        *((unsigned int *)(&DAT_001041c0) + local_c) =
            *((unsigned int *)(&DAT_00104100) + local_c) ^ *((unsigned int *)(&DAT_00104060) + local_c);

        putchar(*((int *)(&DAT_001041c0) + local_c));
    }

    return;
}
// MetaCTF{W3ll_D0n3_Th1s_w4s_W4rmuP}
```

if u thought i wrote one line of that u'd be naive, all credits go to ChatGpt 😖
MetaCTF{W3ll_D0n3_Th1s_w4s_W4rmuP}
